#: import utils kivy.utils

PageManager:
    HomePage:
        id:home
    DataPage:
    SettingsPage:
    DataScroll:

#<Button>:
#    font_size: (root.width + root.height) / 20
<CustButton@Button>:
    font_size: (root.width + root.height) / 5
<MenuButton@Button>:
    font_size: (root.width + root.height) / 10

<HomePage>:
    name: "home"
    display_side: side
    display_cass: cass
    display_model: model
    display_time: time_label

    FloatLayout:
        Image:
            source:'data/logo.png'
            pos_hint: {"x":0, "top": 1}
            text: "LOGO"
            size_hint: .8, .15
        Button:
            background_color:(0,0,0,0)
            size_hint: .2, .13
            pos_hint: {"x":.8, "top": 1}
            on_press: root.login_btn_press()
            on_release: root.login_btn_rel()
            Image:
                id: login_img1
                size_hint_y: None
                size_hint_x: None
                height: root.height / 5
                width: root.width / 5
                source:'data/login_1.png'
                center_x:self.parent.center_x
                center_y:self.parent.center_y

        Label:
            id: time_label
            size_hint: .2, .03
            pos_hint: {"x":.8, "top": .897}
            text: root.now
            font_size:(root.width + root.height) / 60
            color: (1,1,1,1)
            bold: False
            outline_color: (0,0,0,1)
            outline_width:1

        Button:
            id: model
            text:root.current_base
            font_size: (root.width + root.height) / 45
            pos_hint: {'x': 0, 'top': .85}
            size_hint: 1, .07
            on_release:
                app.root.current = 'data'
                root.manager.transition.direction = 'left'
        Button:
            id: delete_left
            text: ">>>"
            text_color: utils.get_color_from_hex('#FF5733')
            font_size: (root.width + root.height) / 45
            pos_hint: {'x': 0, 'top': .78}
            size_hint: .33, .07
            on_press: entry.text = ""
            on_press: cass.text = ""
            on_press: side.text = ""
        Label:
            id: entry
            background_color: (240/255, 148/255,22/255, 1)
            canvas.before:
                Color:
                    rgba: self.background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
            # text Properties
            color: (0,0,0,1)
            bold: False
            outline_color: (1,1,1,1)
            outline_width:1
            font_size: (root.width + root.height) / 30
            multiline: False
            pos_hint: {'x': 0.33, 'top': .78}
            size_hint: .34, .07
        Button:
            id: delete_right
            text: "<<<"
            font_size: (root.width + root.height) / 45
            pos_hint: {'x': 0.67, 'top': .78}
            size_hint: .33, .07
            on_press: entry.text = ""
            on_press: side.text = ""
            on_press: cass.text = ""

        Button:
            text: "ВРЕМЯ ЗВУЧАНИЯ"
            font_size: (root.width + root.height) / 45
            pos_hint: {'x': 0, 'top': .71}
            size_hint: 1, .072
            on_press: root.calculator(entry.text)
            on_press: self.background_color = (55/255, 55/255, 55/255, 1)
            on_release: self.background_color = (1, 1, 1, 1)
            on_release: delete_left.color = (1, 1, 1, 1)
            on_release: delete_right.color = (1, 1, 1, 1)

        Label:
            text: "СТОРОНА"
            background_color: (80/255, 80/255, 80/255, 1)
            font_size: (root.width + root.height) / 45
            pos_hint: {'x': .502, 'top': .638}
            size_hint: .5, .07
            canvas.before:
                Color:
                    rgba: self.background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
        Label:
            font_size: (root.width + root.height) / 45
            text: "КАССЕТА"
            background_color: (80/255, 80/255, 80/255, 1)
            pos_hint: {'x': 0, 'top': .638}
            size_hint: .498, .07
            canvas.before:
                Color:
                    rgba: self.background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
        Label:
            id: side
            background_color: (80/255, 80/255, 80/255, 1)
            font_size: (root.width + root.height) / 33
            pos_hint: {'x': .502, 'top': .57}
            size_hint: .498, .07
            canvas.before:
                Color:
                    rgba: self.background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
        Label:
            id: cass
            background_color: (80/255, 80/255, 80/255, 1)
            font_size: (root.width + root.height) / 33
            pos_hint: {'x': 0, 'top': .57}
            size_hint: .498, .07
            canvas.before:
                Color:
                    rgba: self.background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
        GridLayout:
            pos_hint: {'x': 0, 'y': .09}
            size_hint: 1, .4
            id: calculator
            display: entry
            cols: 3
            padding: 10
            spacing: 10
            CustButton:
                text: "7"
                on_press: entry.text += self.text
            CustButton:
                text: "8"
                on_press: entry.text += self.text
            CustButton:
                text: "9"
                on_press: entry.text += self.text
            CustButton:
                text: "4"
                on_press: entry.text += self.text
            CustButton:
                text: "5"
                on_press: entry.text += self.text
            CustButton:
                text: "6"
                on_press: entry.text += self.text
            CustButton:
                text: "3"
                on_press: entry.text += self.text
            CustButton:
                text: "2"
                on_press: entry.text += self.text
            CustButton:
                text: "1"
                on_press: entry.text += self.text
            CustButton:
                text: "."
                on_press: entry.text += self.text
            CustButton:
                text: "0"
                on_press: entry.text += self.text
            CustButton:
                text: "<|"
                on_press: entry.text = entry.text[0:-1]


        BoxLayout:
            padding: 5
            pos_hint: {'x': 0.25, 'y': 0}
            size_hint: 0.5, 0.088
            cols:1
            MenuButton:
                text:'Выход'
                on_release: app.exit_app()

<DataPage>:
    name:"data"
    counter_input: counter_input
    timer_input: timer_input
    FloatLayout:
        Button:
            pos_hint: {"x":0, "top": 1}
            size_hint: 0.35, 0.07
            color: (0,0,0,1)
            background_normal: ''
            background_color:(240/255, 148/255,22/255, 1)
            text_color:
            size: self.texture_size
            text: '  < НАЗАД'
            text_size: self.size
            font_size: (root.width + root.height) / 55
            halign: 'left'
            valign: 'middle'
            on_press:
                app.root.current = 'home'
                root.manager.transition.direction = 'right'
        Label:
            pos_hint: {"x":0.35, "top": 1}
            size_hint: 0.65, 0.07
            background_color: (240/255, 148/255,22/255, 1)
            font_size: (root.width + root.height) / 55
            text_size: self.size
            color: (0,0,0,1)
            halign: 'right'
            valign: 'middle'
            text: 'БАЗА ДАННЫХ  '
            bold: False
            canvas.before:
                Color:
                    rgba: self.background_color
                Rectangle:
                    size: self.size
                    pos: self.pos

        Label:
            pos_hint: {"x":0, "top": 0.95}
            size_hint: 0.5, 0.1
            text_size: self.size
            font_size: (root.width + root.height) / 50
            text: "Магнитофон:"
            halign: 'right'
        Label:
            id: model
            pos_hint: {"x":0.55, "top": 0.95}
            size_hint: 0.95, 0.1
            text_size: self.size
            font_size: (root.width + root.height) / 50
            text:root.current_base
            halign: 'left'
        Label:
            pos_hint: {"x":0, "top": 0.895}
            size_hint: 0.5, 0.1
            text_size: self.size
            font_size: (root.width + root.height) / 50
            text: "001 счётчика:"
            halign: 'right'
        Label:
            id: models
            pos_hint: {"x":0.55, "top": 0.895}
            size_hint: 0.95, 0.1
            text_size: self.size
            font_size: (root.width + root.height) / 50
            halign: 'left'
            text:root.count_one
        Label:
            pos_hint: {"x":0, "top": 0.84}
            size_hint: 0.5, 0.1
            text_size: self.size
            font_size: (root.width + root.height) / 50
            text: "Кассет в базе:"
            halign: 'right'
        Button:
            id: add_label
            pos_hint: {"x":0, "top": 0.72}
            size_hint: 1, 0.06
            background_normal: ''
            background_color: (100/255, 100/255, 100/255, 1)
            text: "НОВОЕ ПОКАЗАНИЕ:"
            font_size: (root.width + root.height) / 50
            on_press: background_color: (100/255, 100/255, 100/255, 1)
            on_press: counter_input.text = ""
            on_press: timer_input.text = ""
            on_release: self.text = "НОВОЕ ПОКАЗАНИЕ:"
        Label:
            id: readings
            pos_hint: {"x":0.55, "top": 0.84}
            size_hint: 0.95, 0.1
            text_size: self.size
            font_size: (root.width + root.height) / 50
            halign: 'left'
            text:root.readings
        Label:
            id: counter_label
            pos_hint: {"x":0, "top": 0.65}
            size_hint: 1, 0.06
            background_color: (100/255, 100/255, 100/255, 1)
            text: "СЧЁТЧИК:                       ОБОРОТОВ"
            color: (1,1,1,1)
            font_size: (root.width + root.height) / 60
            canvas.before:
                Color:
                    rgba: self.background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
        CounterTextInput:
            id: counter_input
            multiline: False
            focus:True
            input_type: 'number'
            input_filter: 'int'
            pos_hint: {"x":0.4, "top": 0.65}
            size_hint: 0.2, 0.06
            text_size: self.size
            font_size: (root.width + root.height) / 50
        Label:
            id: timer_label
            pos_hint: {"x":0, "top": 0.58}
            size_hint: 1, 0.06
            background_color: (100/255, 100/255, 100/255, 1)
            text: "ВРЕМЯ:                            Ч,М,С"
            color: (1,1,1,1)
            font_size: (root.width + root.height) / 60
            canvas.before:
                Color:
                    rgba: self.background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
        TimerTextInput:
            id: timer_input
            multiline: False
            focus:True
            input_type: 'datetime'
            pos_hint: {"x":0.372, "top": 0.58}
            size_hint: 0.26, 0.06
            text_size: self.size
            font_size: (root.width + root.height) / 50
        Button:
            id: add_btn
            pos_hint: {"x":0.33, "top": 0.51}
            size_hint: 0.35, 0.06
            color: (0,0,0,1)
            background_normal: ''
            background_color:(240/255, 148/255,22/255, 1)
            size: self.texture_size
            text: 'ДОБАВИТЬ'
            text_size: self.size
            font_size: (root.width + root.height) / 55
            halign: 'center'
            valign: 'middle'
            on_press: root.add_new_reading(counter_input.text, timer_input.text)
            on_press: self.background_color = (100/255, 100/255, 100/255, 1)
            on_release: self.background_color = (240/255, 148/255,22/255, 1)
            on_release: timer_label.color = (1, 1, 1, 1)
            on_release: counter_label.color = (1, 1, 1, 1)

<SettingsPage>:
    name:"settings"
    GridLayout:
        cols:1
        GridLayout:
            padding: 5
            size_hint: 1, 0.06
            cols:2
            Button:
                size: self.texture_size
                background_color: [1,0,0,1]
                size_hint: 0.35, 1
                text: '<<< Назад'
                text_size: self.size
                halign: 'left'
                valign: 'middle'
                on_press:
                    app.root.current = 'home'
                    root.manager.transition.direction = 'right'
            Label:
                background_color: 1, 1, 1, 1
                text_size: self.size
                halign: 'right'
                valign: 'middle'
                text: 'НАСТРОЙКИ'
                bold: False
        BoxLayout:
            cols:1
            ScrollView:
                size_hint_y: .75
                pos_hint:{'x':0, 'y':0.10}
                do_scrol_x: False
                do_scrol_y: True
                GridLayout:
                    cols:1
                    size:(root.width, root.height)
                    size_hint_x: None
                    size_hint_y: 1.5
                    cols: 1
                    height: self.minimum_height
                    Label:
                        text: 'Настройки'



